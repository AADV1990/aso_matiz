<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <h:form id="formEmpresa">


        <f:metadata>
            <f:viewAction action="#{empresaController.reiniciarVista()}"/>
        </f:metadata>

        <h:panelGroup>
            <h:outputText value="Formulario de Empresa" styleClass="text-2xl font-bold mb-4"/>
        </h:panelGroup>

        <div class="formulario-grid grid ui-fluid">

            <div class="col-12 md:col-6">
                <p:outputLabel for="razonSo" value="Razón Social"/>
                <p:inputText id="razonSo" value="#{empresaController.entidad.razonSocial}"/>
            </div>

            <div class="col-12 md:col-6">
                <p:outputLabel for="ruc" value="RUC"/>
                <p:inputText id="ruc" value="#{empresaController.entidad.ruc}"/>
            </div>

            <div class="col-12 md:col-6">
                <p:outputLabel for="dire" value="Dirección"/>
                <p:inputText id="dire" value="#{empresaController.entidad.direccion}"/>
            </div>

            <div class="col-12 md:col-6">
                <p:outputLabel for="tel" value="Teléfono"/>
                <p:inputText id="tel" value="#{empresaController.entidad.telefono}"/>
            </div>

            <div class="col-12 md:col-6">
                <p:outputLabel value="Persona *" for="personaInput"/>
                <div class="ui-inputgroup">
                    <!-- ✅ con widgetVar para actualizar desde el diálogo -->
                    <p:inputText id="personaInput"
                                 widgetVar="wPersonaInput"
                                 value="#{empresaController.nombreRepresentante}"
                                 readonly="true"
                                 styleClass="w-full"/>

                    <!-- ✅ abre el diálogo correcto y marca origen -->
                    <p:commandButton icon="pi pi-search"
                                      title="Buscar persona"
                                      action="#{personaController.setFormularioOrigen(':abmForm:formEmpresa', ':abmForm:formEmpresa:personaInput')}"
                                      oncomplete="PF('dlgSeleccionarPersona').show()"
                                      process="@this" update="@none">
                    <f:setPropertyActionListener value="#{empresaController}"
                                                 target="#{personaController.origen}" />
                </p:commandButton>
                </div>
            </div>
        </div>

        <div class="col-12 md:col-6">
            <p:outputLabel for="activo" value="Activo"/>
            <p:selectBooleanCheckbox id="activo"
                                     value="#{empresaController.entidad.activo}"
                                     styleClass="me-2"/>
        </div>
    </h:form>
</ui:composition>
